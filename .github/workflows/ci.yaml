name: CI

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  ci:
    name: Build and test
    runs-on: macos-15
    env:
      XCODE_VERSION: ${{ '16.4' }}
    steps:
      - name: Select Xcode
        run: "sudo xcode-select -s /Applications/Xcode_$XCODE_VERSION.app"
      - name: Checkout
        uses: actions/checkout@v4
      - name: Build project
        run: swift build
      - name: Run tests
        run: swift test
      - name: Build example iOS app
        run: |
          cd Example
          bazel build //HelloWorld
      # TODO: add test target to the example iOS app
      # - name: Test example iOS app
      #   run: |
      #     cd Example
      #     bazel test //HelloWorld/HelloWorldTests/...
